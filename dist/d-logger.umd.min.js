!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("moment"),require("node-emojify")):"function"==typeof define&&define.amd?define(["exports","moment","node-emojify"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self)["d-logger"]={},e.moment,e["node-emojify"])}(this,(function(e,n,t){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o,i,u,c=r(n),l=r(t);function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function s(e){var n=function(e,n){if("object"!==f(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===f(n)?n:String(n)}function g(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function p(e,n,t){return n&&g(e.prototype,n),t&&g(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function v(e,n){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},v(e,n)}function h(e,n){if(n&&("object"===f(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var m={emerg:"emerg",alert:"alert",crit:"crit",error:"error",warn:"warn",warning:"warning",notice:"notice",info:"info",debug:"debug"},b=(d(o={},m.emerg,console.trace),d(o,m.alert,console.trace),d(o,m.crit,console.trace),d(o,m.error,console.error),d(o,m.warn,console.warn),d(o,m.warning,console.warning),d(o,m.notice,console.info),d(o,m.info,console.info),d(o,m.debug,console.debug),o),w=(d(i={},m.emerg,"red"),d(i,m.alert,"orange"),d(i,m.crit,"red"),d(i,m.error,"red"),d(i,m.warn,"yellow"),d(i,m.warning,"yellow"),d(i,m.notice,"blue"),d(i,m.info,"green"),d(i,m.debug,"rainbow"),i),O=(d(u={},m.emerg,0),d(u,m.alert,1),d(u,m.crit,2),d(u,m.error,3),d(u,m.warn,4),d(u,m.warning,4),d(u,m.notice,5),d(u,m.info,6),d(u,m.debug,7),u);function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function _(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,u,c=[],l=!0,a=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=i.call(t)).done)&&(c.push(r.value),c.length!==n);l=!0);}catch(e){a=!0,o=e}finally{try{if(!l&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(a)throw o}}return c}}(e,n)||function(e,n){if(e){if("string"==typeof e)return k(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?k(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var j={date:function(e){return function(n){var t=n.date,r=n.dateL10n,o=void 0===r?"en":r;return c.default(t).locale(o).format(e)}},location:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){return function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return e;var n=e.replaceAll(/[()]/g,"").split("///").pop();return n.includes("!./")&&(n=n.split("!./").pop()),n}(n.location,e)}},message:function(){return function(e){return e.message}},text:function(e){return function(){return l.default(e)}},level:function(){return function(e){return e.level.toUpperCase()}},levelDate:function(e){return function(n){var t=n.level,r=n.date,o=n.dateL10n,i=c.default(r).locale(o).format(e),u=t.toUpperCase();return"".concat(i," | ").concat(u)}},newLine:function(){return function(){return"\n"}}};function L(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(e){return n.reduce((function(n,t){return"".concat(n).concat(t(e))}),"")}}function S(e,n){return O[e]<=O[n]}function A(e){return null==e?e:e?e.length:0}function E(e,n){return"".concat(n,":").concat(A(e))}function P(e){if(!e)return e;for(var n=JSON.parse(JSON.stringify(e)),t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.forEach((function(e){for(var t=n,r=e,o=e.split("."),i=o.length;i<0;i-=1){var u=o[o.length-i];i>1&&(t=t[u]),r=u}t[r]=E(t[r],r)})),n}function C(e,n){var t=e;return Object.entries(n).forEach((function(e){var n=_(e,2),r=n[0],o=n[1];o&&(t[r]=o)})),t}function M(){return{format:function(e){return"function"==typeof(n=e)&&(n=n()),function(e){return!!(e&&e.stack&&e.message)}(n)?n.toString():"object"===f(n)||Array.isArray(n)?JSON.stringify(n):String(n);var n},level:m.info,template:function(e){return e}}}var I=p((function e(n,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"en";a(this,e),d(this,"level",null),d(this,"message",null),d(this,"date",null),d(this,"location",null),d(this,"dateL10n","en"),this.level=n,this.message=t,this.date=r,this.location=o,this.dateL10n=i})),D=function(){function e(n){a(this,e),d(this,"config",null),this.config=e.mergeConfigs(M(),n)}return p(e,[{key:"isAllowed",value:function(e){return S(e,this.config.level)}},{key:"format",value:function(e){return this.config.format(e)}},{key:"getMessage",value:function(e){return this.config.template(e)}},{key:"creatingMessage",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t||(t=this.config.level),r||(r=this.config.stepInStack),o||(o=this.config.dateL10n),!this.isAllowed(t)||!e)return null;var i=e.reduce((function(e,t){return"".concat(e," ").concat(n.format(t))}),""),u=new I(t,i,new Date,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{throw new Error("Log stack")}catch(r){try{var n=r.stack.split("\n").map((function(e){return e.trim()})).filter((function(e){return e.startsWith("at")}));if(n.length<=e)return"parameter stepInStack is not valid. "+"stepInStack = ".concat(e," ")+"but stack length = ".concat(n.length);var t=String(n[e]);return t.includes("(")?t.slice(t.indexOf("(")):t.slice(3)}catch(e){return""}}}(r),o);return this.getMessage(u)}},{key:"log",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.creatingMessage(e,n,t,r)}}],[{key:"mergeConfigs",value:function(e,n){return C(e,n)}}]),e}();function x(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=y(e);if(n){var o=y(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return h(this,t)}}var R=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&v(e,n)}(t,e);var n=x(t);function t(e){a(this,t);var r=D.mergeConfigs({level:"info",colorize:!0,template:L(j.levelDate("DD.MM.YYYY HH:mm:ss"),j.newLine(),j.location(),j.newLine(),j.message()),stepInStack:6,dateL10n:"en"},e);return n.call(this,r)}return p(t,[{key:"__getConsoleMethod",value:function(e){if(e in b){var n=b[e];if(n)return n}return console.log}},{key:"log",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=this.creatingMessage(e,n,t,r);if(!o)return null;var i=this.__getConsoleMethod(n);return this.config.colorize?i("%c".concat(o,"\n"),"color: ".concat(w[n])):i("".concat(o,"\n")),o}}]),t}(D);var T=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),d(this,"config",null),this.configure(n||{})}return p(e,[{key:"configure",value:function(e){this.config=C({appenders:[],level:"undefined"!=typeof process&&process.argv&&process.argv.includes("--debug-mode")?"debug":process.env.D_LOGGER_LOG_LEVEL||process.env.VUE_APP_D_LOGGER_LOG_LEVEL||"debug",template:null,stepInStack:6,dateL10n:"en"},e),0===this.config.appenders.length&&this.addConsoleAppender(this.config.level,!0,null,this.config.stepInStack),this.__defineLogMethods()}},{key:"__defineLogMethods",value:function(){var e=this;Object.keys(m).forEach((function(n){e[n]=e.__log(n)}))}},{key:"addConsoleAppender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"en";this.config.appenders.push(new R({level:e||this.config.level,colorize:n,template:t||this.config.template,stepInStack:r||this.config.stepInStack,dateL10n:o||this.config.dateL10n}))}},{key:"addCustomAppender",value:function(e){return this.config.appenders.push(e)}},{key:"clearAppenders",value:function(){this.config.appenders=[]}},{key:"__log",value:function(e){var n=this;if(!S(e,this.config.level))return function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n};if(!this.config.appenders||0===this.config.appenders.length)throw new Error("log list appenders is empty");return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.config.appenders.forEach((function(n){return n.log(r,e)}))}}},{key:"logProcessEnvs",value:function(){var e="";Object.keys(process.env).forEach((function(n){e+="".concat(n,"=").concat(process.env[n],";\n")})),this.info("Process envs:\n\n".concat(e))}},{key:"dprsObj",value:function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return P.apply(void 0,[e].concat(t))}},{key:"dprsValue",value:function(e,n){return E(e,n)}},{key:"len",value:function(e){return A(e)}}]),e}(),G=new T,V={install:function(e,n){n&&n.logConfig&&G.configure(n.logConfig),e.prototype.$log=G}};e.$log=G,e.ConsoleAppender=R,e.DLogger=T,e.DLoggerPlugin=V,e.LOG_LEVEL=m,e.LogAppender=D,e.LogMessageInfo=I,e.createTemplate=L,e.templateFns=j,Object.defineProperty(e,"__esModule",{value:!0})}));
